#!/usr/bin/env bash
set -euo pipefail

# ========================================================
SCRIPTS_DIR="ğŸ’›æ”¾ç½®pyæ–‡ä»¶å’Œvenvä¾èµ–ç¯å¢ƒçš„æ–‡ä»¶å¤¹"
CERT_DIR="â¤ï¸ä½ æ”¾è¯ä¹¦çš„æ–‡ä»¶å¤¹"
# ========================================================

FULLCHAIN="${CERT_DIR}/fullchain.pem"
PRIVKEY="${CERT_DIR}/privkey.pem"

test -s "$FULLCHAIN" || { echo "fullchain.pem missing/empty"; exit 1; }
test -s "$PRIVKEY"   || { echo "privkey.pem missing/empty"; exit 1; }

# ========================================================
export SAFELINE_BASE_URL="ğŸ”®ä½ çš„é›·æ± åç«¯åœ°å€"
export SAFELINE_CERT_ID="ğŸ’šä½ çš„è¯ä¹¦ID"
export SAFELINE_API_TOKEN="ğŸ’™ä½ çš„æ–°token"
# ========================================================

"$SCRIPTS_DIR/venv/bin/python" \
"$SCRIPTS_DIR/update_safeline.py" \
"$FULLCHAIN" "$PRIVKEY"